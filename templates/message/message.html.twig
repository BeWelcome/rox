{% import 'macros.twig' as macros %}
{% extends 'base.html.twig' %}

{% block subnav %}
    {% for filter, menuitem in submenu.items %}
        <a class="list-group-item nav-link {% if submenu.active == filter %}active{% endif %}"
           href="{{ path( submenu.route, { filter: filter } ) }}">{{ filter | trans }}</a>
    {% endfor %}
{% endblock %}

{% block stylesheets %}
    {{ encore_entry_link_tags('tailwind') }}
{% endblock stylesheets %}

{% block content %}
    {% set myself = app.user %}

        <div class="u-flex u-justify-between bg-white p-1 mb-2">
            <div class="o-avatar">{{ macros.roundedavatarstack(receiver.Username, 50, false) }}</div>
            <div class="u-items-between">
                <div class="u-text-32  u-text-center u-leading-48 u-text-black u-font-700 u-line-clamp-1">{{ 'message.write_to' | trans | format(receiver.Username) }}
                    <a class="u-text-16 u-align-top" href="{{ url('all_messages_with', {'username': receiver.Username}) }}">
                        <i class="fas fa-mail-bulk"
                           title="{{ 'messages_allmessageswith' | trans | format(receiver.Username) }}"></i>
                    </a>
                </div>
                {% set languages %}{% for level in receiver.languageLevels %}
                    {% apply spaceless %}
                        {{ ('lang_' ~ level.language.shortcode) | trans }}<span class="d-none d-md-inline">
                         ({{ ('languagelevel_' ~ level.level) | lower | trans }})</span>
                        {%- if not loop.last -%}
                            ,
                        {%- endif -%}
                    {% endapply %}
                {% endfor %}{% endset %}
                <div class="u-text-16 u-line-clamp-2">{{ 'lives.and.speaks' | trans({'city': receiver.city.name ~ ', ' ~ receiver.city.country.name | capitalize, 'languages': languages }) | raw }}</div>
            </div>
            <div class="o-avatar">{{ macros.roundedavatarstack(myself.Username, 50, true) }}</div>
        </div>

    <div class="row no-gutters">
        <div class="col-12 mb-2">
            {{ form_start(form, {'attr': {'novalidate': 'novalidate'}}) }}
            {{ form_errors(form) }}
            {{ form_row(form.subject.subject) }}
            {{ form_row(form.message) }}
            {{ form_rest(form) }}
        </div>

        <div class="col-12 mb-2">
            <div class="u-flex u-justify-end">
                <button type="submit" class="btn btn-primary">{{ 'message.send' | trans }}</button>
            </div>
        </div>
        {{ form_end(form) }}
    </div>
{% endblock %}
